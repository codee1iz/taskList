## ЖК "Пантелеон" 

| Событие | Название | Категория | 
| :------ | ---- | ---- | 
| VKACTF kids 2025 |ЖК "Пантелеон"  | Misc | 

  
### Описание
После взлома системы безопасности ЖК "Пантелеон" был обнаружён доступ к камерам наблюдения. Однако третья камера, установленная в подвале, почему-то не работала. Логи показывали, что система перенаправляет запрос...


> Автор: e1iz4vr
>

### Решение

Подключаемся к сервису:

```
http://[HOST]:[PORT]
```
![image](./images/image1)
Появляется страница входа. Пробуем стандартные креды — `admin:admin` подходит.

После авторизации — панель управления с тремя камерами:
- Камера 1 — работает  
- Камера 2 — работает  
- Камера 3 — "не работает"

Нажимаем на **Камеру 3** — визуально ничего не происходит.  
Перехватываем запрос с помощью прокси:

```
POST /api/v2/camera/start HTTP/1.1
```
Видно, что файлы принимаются через query-параметр `/video?file=camera1_video.mp4`, пробуем протестировать уязвимость path traversal, перебрав значения находим файл `/video?file=../main.py`. После анализа кода можно заметить, что сервис работает на 2-х версиях API. После чего остается отправить нужный запрос на ручку для получения видео.
```python
 token = data.get('token')
        if token == 'gold':
            return jsonify({"status": "ok", "video": "/video?file=s1ec1re1t_video.mp4"})
```
Либо сразу предполагаем наличие устаревшей версии API и пробуем отправить запрос на `/api/v1/camera/start`.  
Получаем ответ:

```json
{"error":"token = gold"}
```
![image](./images/image2)
Добавляем параметр `"token":"gold"` в тело запроса к `/api/v1/camera/start` — получаем доступ к видеопотоку с третьей камеры.

Видео запускается, но визуально не содержит флага. При прослушивании аудиодорожки слышен высокочастотный писк — подозрительно на стеганографию.

Для анализа используем **Sonic Visualiser**. Строим спектрограмму — на изображении проявляется **QR-код**.

Сканируем QR-код и получаем флаг:
![image](./images/image3)
```
vka{st3g0_v_v3b3_z4ch3m?}
```
